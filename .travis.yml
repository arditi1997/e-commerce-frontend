dist: trusty
sudo: required
language: generic

services:
 - docker

cache:
  directories:
    - ./node_modules

before_install:
 - docker build -t frontend .

before_script:
 - rm -rf node_modules
 - npm cache clean -f 
 - nvm install 12
 - nvm install 14
 - nvm use 14
 - npm install -g --save @angular/cli@13.1.3
 - npm i -g @angular-eslint/builder  
 - npm link @angular/cli@13.1.3
 - ng version
 - ng g @angular-eslint/schematics:add-eslint-to-project     

script:
 - ng lint
 - ng build --prod --base-href https://github.com/arditi1997/e-commerce-frontend
 - docker run frontend npm run test -- --watch=false --no-progress --browsers=ChromeHeadlessNoSandbox

